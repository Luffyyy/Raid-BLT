#ifndef __FUNCTIONPATTERN_H__
#define __FUNCTIONPATTERN_H__

#include <string_view>

#define DEFINE_LUA_FUNCTION_PATTERN(name, pattern) \
	static constexpr std::string_view name ## _pattern = pattern;

DEFINE_LUA_FUNCTION_PATTERN(lua_call, "48 63 C2 4C 8B D1 48 8B 51 28 48 C1 E0 03 4C 8B CA 4C 2B C8 48 8D 42 08 48 89 41 28")
DEFINE_LUA_FUNCTION_PATTERN(luaL_newstate, "48 89 5C 24 08 48 89 74 24 10 57 48 83 EC 20 41 0F B6 F8 0F B6 F2 48 8B D9 45 85 C9")
DEFINE_LUA_FUNCTION_PATTERN(lua_pcall, "48 89 5C 24 08 48 89 74 24 10 57 48 83 EC 20 48 8B 59 10 41 8B F0 4C 63 DA 4C 8B D1 0F B6 BB C1")
DEFINE_LUA_FUNCTION_PATTERN(lua_gettop, "48 8B 41 28 48 2B 41 20 48 C1 F8 03 C3")
DEFINE_LUA_FUNCTION_PATTERN(lua_settop, "40 53 48 83 EC 20 48 8B D9 85 D2 78 ?? 4C 8B 41")
DEFINE_LUA_FUNCTION_PATTERN(lua_toboolean, "48 83 EC 28 E8 ?? ?? ?? ?? 48 8B 08 33 C0 48 C1")
DEFINE_LUA_FUNCTION_PATTERN(lua_tointeger, "48 83 EC 28 E8 ?? ?? ?? ?? 48 8B 10 48 8B CA 48 C1 F9 2F 83 F9 F2 ?? ?? F2 0F 10 00 F2 48 0F")
DEFINE_LUA_FUNCTION_PATTERN(lua_tonumber, "48 83 EC 28 E8 ?? ?? ?? ?? 48 8B 10 48 8B CA 48 C1 F9 2F 83 F9 F2 ?? ?? F2 0F 10 00 48 83 C4")
DEFINE_LUA_FUNCTION_PATTERN(lua_tolstring, "48 89 5C 24 08 48 89 74 24 10 57 48 83 EC 20 49 8B F8 8B DA 48 8B F1")
DEFINE_LUA_FUNCTION_PATTERN(lua_objlen, "40 53 48 83 EC 20 4C 8B D9 E8 ?? ?? ?? ?? 48 8B")
DEFINE_LUA_FUNCTION_PATTERN(luaL_loadfilex, "48 89 5C 24 20 55 56 57 48 81 EC 50 02 00 00 48")
DEFINE_LUA_FUNCTION_PATTERN(luaL_loadstring, "48 83 EC 48 48 89 54 24 30 48 83 C8 FF 0F 1F 00")
DEFINE_LUA_FUNCTION_PATTERN(lua_getfield, "48 89 5C 24 10 57 48 83 EC 20 4D 8B D8 48 8B D9")
DEFINE_LUA_FUNCTION_PATTERN(lua_setfield, "48 89 5C 24 08 57 48 83 EC 20 4D 8B D8 48 8B D9")
DEFINE_LUA_FUNCTION_PATTERN(lua_createtable, "48 89 5C 24 08 48 89 74 24 10 57 48 83 EC 20 4C 8B 49 10 41 8B F8 8B F2 48 8B D9 49 8B 41 28 49")
DEFINE_LUA_FUNCTION_PATTERN(lua_insert, "4C 8B C9 85 D2 7E ?? 8D 42 FF 48 63 D0 48 8B 41")
DEFINE_LUA_FUNCTION_PATTERN(lua_remove, "4C 8B C1 85 D2 7E ?? 8D 42 FF 48 63 D0 48 8B 41 20 48 8B 49 28 48 8D 04 D0 48 3B C1")
DEFINE_LUA_FUNCTION_PATTERN(lua_newstate, "48 89 5C 24 08 48 89 6C 24 10 48 89 74 24 18 57 48 83 EC 20 48 8B F2 48 8B E9 48 8B CE 41 B9 70")
DEFINE_LUA_FUNCTION_PATTERN(lua_close, "48 89 5C 24 08 48 89 6C 24 10 48 89 74 24 18 57 48 83 EC 20 48 8B 79 10 48 8B B7 C8 00 00 00 48")
DEFINE_LUA_FUNCTION_PATTERN(lua_settable, "40 53 48 83 EC 20 48 8B D9 E8 ?? ?? ?? ?? 4C 8B 43 28 48 8B D0 49 83 E8 10")
DEFINE_LUA_FUNCTION_PATTERN(lua_pushinteger, "48 8B 41 28 0F 57 C0 F2 48 0F 2A C2 F2 0F 11 00")
DEFINE_LUA_FUNCTION_PATTERN(lua_pushboolean, "48 8B 41 28 45 33 C0 85 D2 41 0F 95 C0 49 FF C0")
DEFINE_LUA_FUNCTION_PATTERN(lua_pushcclosure, "48 89 5C 24 08 48 89 74 24 10 57 48 83 EC 20 4C 8B 49 10 48 8B F2 49 63 F8 48 8B D9 49 8B 41 28")
DEFINE_LUA_FUNCTION_PATTERN(lua_pushlstring, "48 89 5C 24 08 48 89 74 24 10 57 48 83 EC 20 4C 8B 49 10 49 8B F8 48 8B F2 48 8B D9 49 8B 41 28")
DEFINE_LUA_FUNCTION_PATTERN(lua_pushstring, "48 89 5C 24 08 57 48 83 EC 20 48 8B FA 48 8B D9 48 85 D2 75 ?? 48 8B 41 28 49 83 C8 FF 4C 89 00")
DEFINE_LUA_FUNCTION_PATTERN(lua_checkstack, "40 53 48 83 EC 20 48 8B D9 81 FA 40 1F 00 00 7F")
DEFINE_LUA_FUNCTION_PATTERN(luaI_openlib, "48 89 5C 24 10 48 89 6C 24 18 48 89 74 24 20 57 48 83 EC 20 48 8B 41 28")
DEFINE_LUA_FUNCTION_PATTERN(luaL_ref, "48 89 5C 24 20 57 48 83 EC 20 8D 82 0F 27 00 00")
DEFINE_LUA_FUNCTION_PATTERN(lua_rawgeti, "40 53 48 83 EC 20 4D 63 D8 48 8B D9 E8 ?? ?? ?? ?? 48 BA FF FF FF FF FF")
DEFINE_LUA_FUNCTION_PATTERN(lua_rawseti, "48 89 5C 24 08 48 89 74 24 10 57 48 83 EC 20 4D 63 D8 48 8B D9 E8")
DEFINE_LUA_FUNCTION_PATTERN(lua_type, "48 83 EC 28 4C 8B D9 E8 B4 D9 FE FF 48 8B D0 48")
//DEFINE_LUA_FUNCTION_PATTERN(lua_typename, "8D 42 01 48 98 48 8D 0D A4 69 37 00 48 8B 04 C1")
DEFINE_LUA_FUNCTION_PATTERN(luaL_unref, "45 85 C0 0F 88 ?? ?? ?? ?? 48 89 5C 24 08 48 89")

DEFINE_LUA_FUNCTION_PATTERN(application_update, "48 89 5C 24 10 48 89 6C 24 18 48 89 74 24 20 57 41 56 41 57 48 83 EC 50 0F 29 74 24 40 0F 29 7C 24 30 48 8B F9")
DEFINE_LUA_FUNCTION_PATTERN(lua_application_register, "48 89 5C 24 08 48 89 7C 24 10 55 48 8B EC 48 83 EC 40 48 8B D9 65 48 8B 04 25 58 00 00 00 B9 80")

#undef DEFINE_LUA_FUNCTION_PATTERN

#endif
